"use strict";(self.webpackChunkfloristby=self.webpackChunkfloristby||[]).push([[373],{2373:(e,n,a)=>{a.r(n),a.d(n,{default:()=>Y});var r,t=a(5893),o=a(1072),l=a(1150);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(r||(r={}));var i=a(7168),u=(0,i.hg)("profile/fetchProfileData",(function(e,n){return a=void 0,r=void 0,o=function(){var a,r,t;return function(e,n){var a,r,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(a=1,r&&(t=2&i[0]?r.return:i[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,i[1])).done)return t;switch(r=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){l.label=i[1];break}if(6===i[0]&&l.label<t[1]){l.label=t[1],t=i;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(i);break}t[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],r=0}finally{a=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(o){switch(o.label){case 0:a=n.extra,r=n.rejectWithValue,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.api.get("/profile/".concat(e))];case 2:if(!(t=o.sent()).data)throw new Error;return[2,t.data];case 3:return o.sent(),[2,r("error")];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function l(e){try{u(o.next(e))}catch(e){n(e)}}function i(e){try{u(o.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}u((o=o.apply(a,r||[])).next())}));var a,r,t,o})),c=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.form},s=(0,i.hg)("profile/updateProfileData",(function(e,n){return a=void 0,t=void 0,l=function(){var e,a,t,o,l,i;return function(e,n){var a,r,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(a=1,r&&(t=2&i[0]?r.return:i[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,i[1])).done)return t;switch(r=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){l.label=i[1];break}if(6===i[0]&&l.label<t[1]){l.label=t[1],t=i;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(i);break}t[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],r=0}finally{a=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(u){switch(u.label){case 0:if(e=n.extra,a=n.rejectWithValue,t=n.getState,o=c(t()),(l=function(e){if(!e)return[r.NO_DATA];var n=e.first,a=e.lastname,t=e.age,o=e.country,l=[];return n&&a||l.push(r.INCORRECT_USER_DATA),(!t||!Number.isInteger(t)||t>200||t<0)&&l.push(r.INCORRECT_AGE),o||l.push(r.INCORRECT_COUNTRY),l}(o)).length)return[2,a(l)];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.api.put("/profile/".concat(null==o?void 0:o.id),o)];case 2:if(!(i=u.sent()).data)throw new Error;return[2,i.data];case 3:return u.sent(),[2,a([r.SERVER_ERROR])];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function r(e){try{u(l.next(e))}catch(e){n(e)}}function i(e){try{u(l.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof o?a:new o((function(e){e(a)}))).then(r,i)}u((l=l.apply(a,t||[])).next())}));var a,t,o,l})),d=function(){return d=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var t in n=arguments[a])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},d.apply(this,arguments)},f=(0,i.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.validateError=void 0,e.form=e.data},updateProfile:function(e,n){e.form=d(d({},e.form),n.payload)},saveProfile:function(e){e.readonly=!0}},extraReducers:function(e){e.addCase(u.pending,(function(e){e.error=void 0,e.isLoading=!0})),e.addCase(u.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})),e.addCase(u.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})),e.addCase(s.pending,(function(e){e.validateError=void 0,e.isLoading=!0})),e.addCase(s.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateError=void 0})),e.addCase(s.rejected,(function(e,n){e.isLoading=!1,e.validateError=n.payload}))}}),v=f.actions,p=f.reducer,h=a(4611);const g={ProfileCard:"wW9jgKKD",editing:"DjTe7269",input:"ZTyX8_n9",loading:"t07ZxFGs",error:"i5YK3SSb",avatarWrapper:"bEFNSahN"};var y,m=a(4809),C=a(6925),R=a(4002),b=a(71);!function(e){e.USD="$ USD",e.EUR="€ EUR",e.GBP="£ GBP"}(y||(y={}));var N,x=a(7808),E=a(7294),j=[{value:y.USD,content:y.USD},{value:y.EUR,content:y.EUR},{value:y.GBP,content:y.GBP}],O=(0,E.memo)((function(e){var n=(0,o.$G)("profilePage").t,a=e.className,r=void 0===a?"":a,l=e.value,i=e.readonly,u=void 0===i||i,c=e.onChange,s=(0,E.useCallback)((function(e){null==c||c(e)}),[c]);return(0,t.jsx)(x.P,{className:(0,h.A)("",{},[r]),label:n("Укажите валюту"),options:j,value:l,onChange:s,readonly:u})}));O.displayName="CurrencySelect",function(e){e.Lithuania="Lithuania",e.Poland="Poland",e.US="United States"}(N||(N={}));var P=[{value:N.Lithuania,content:N.Lithuania},{value:N.Poland,content:N.Poland},{value:N.US,content:N.US}],T=(0,E.memo)((function(e){var n=(0,o.$G)("profilePage").t,a=e.className,r=void 0===a?"":a,l=e.value,i=e.readonly,u=void 0===i||i,c=e.onChange,s=(0,E.useCallback)((function(e){null==c||c(e)}),[c]);return(0,t.jsx)(x.P,{className:(0,h.A)("",{},[r]),label:n("Укажите страну"),options:P,value:l,onChange:s,readonly:u})}));T.displayName="CountrySelect";var A=function(e){var n,a,r=(0,o.$G)("profilePage").t,l=e.className,i=void 0===l?"":l,u=e.data,c=e.isLoading,s=void 0!==c&&c,d=e.error,f=void 0===d?"":d,v=e.readonly,p=void 0===v||v,y=e.onChangeFirstname,N=e.onChangeLastname,x=e.onChangeAge,E=e.onChangeCity,j=e.onChangeUsername,P=e.onChangeAvatar,A=e.onChangeCurrency,S=e.onChangeCountry,w=((n={})[g.editing]=!p,n);return s?(0,t.jsx)("div",{className:(0,h.A)(g.ProfileCard,(a={},a[g.loading]=!0,a),[i]),children:(0,t.jsx)(R.a,{})}):f?(0,t.jsx)("div",{className:(0,h.A)(g.ProfileCard,{},[i,g.error]),children:(0,t.jsx)(m.xv,{theme:m.lg.ERROR,align:m.PH.CENTER,title:r("Ошибка"),text:r("Непредвиденная ошибка")})}):(0,t.jsx)("div",{className:(0,h.A)(g.ProfileCard,w,[i]),children:(0,t.jsxs)("div",{className:g.data,children:[(null==u?void 0:u.avatar)&&(0,t.jsx)("div",{className:g.avatarWrapper,children:(0,t.jsx)(b.q,{src:null==u?void 0:u.avatar,alt:r("Аватар"),size:b.D.LARGE})}),(0,t.jsx)(C.I,{value:null==u?void 0:u.first,className:g.input,placeholder:r("Ваше имя"),onChange:y,readonly:p}),(0,t.jsx)(C.I,{value:null==u?void 0:u.lastname,className:g.input,placeholder:r("Ваша фамилия"),onChange:N,readonly:p}),(0,t.jsx)(C.I,{value:null==u?void 0:u.age,className:g.input,placeholder:r("Ваш возраст"),onChange:x,readonly:p}),(0,t.jsx)(C.I,{value:null==u?void 0:u.city,className:g.input,placeholder:r("Город"),onChange:E,readonly:p}),(0,t.jsx)(C.I,{value:null==u?void 0:u.username,className:g.input,placeholder:r("Имя пользователя"),onChange:j,readonly:p}),(0,t.jsx)(C.I,{value:null==u?void 0:u.avatar,className:g.input,placeholder:r("Введите ссылку на аватар"),onChange:P,readonly:p}),(0,t.jsx)(O,{className:g.input,onChange:A,readonly:p,value:null==u?void 0:u.currency}),(0,t.jsx)(T,{className:g.input,onChange:S,readonly:p,value:null==u?void 0:u.country})]})})},S=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.isLoading},w=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.data},k=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.error},I=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.readonly},_=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.validateError},L=a(5461),U=a(5998);const G="vP5lJqeW";var D=a(9161),M=a(3574),V=function(e){var n=e.className,a=void 0===n?"":n,r=(0,o.$G)("profilePage").t,l=(0,U.v9)(M.m5),i=(0,U.v9)(w),u=(null==l?void 0:l.id)===(null==i?void 0:i.id),c=(0,U.v9)(I),d=(0,L.T)(),f=(0,E.useCallback)((function(){d(v.setReadonly(!1))}),[d]),p=(0,E.useCallback)((function(){d(v.cancelEdit())}),[d]),g=(0,E.useCallback)((function(){d(s())}),[d]);return(0,t.jsxs)("div",{className:(0,h.A)("FPJSgL1_",{},[a]),children:[(0,t.jsx)(m.xv,{title:r("Профиль")}),u&&(0,t.jsx)("div",{className:"RSsPrFbn",children:c?(0,t.jsx)(D.zx,{theme:D.bn.OUTLINE,className:G,onClick:f,children:r("Редактировать")}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.zx,{theme:D.bn.OUTLINE_RED,className:G,onClick:p,children:r("Отменить")}),(0,t.jsx)(D.zx,{theme:D.bn.OUTLINE,className:G,onClick:g,children:r("Сохранить")})]})})]})},F=a(2276),W=a(9250),$=a(314),z={profile:p};const Y=function(e){e.className;var n,a=(0,o.$G)("profilePage").t,i=(0,L.T)(),s=(0,U.v9)(c),d=(0,U.v9)(S),f=(0,U.v9)(k),p=(0,U.v9)(I),h=(0,U.v9)(_),g=(0,W.UO)().id,y=((n={})[r.SERVER_ERROR]=a("Серверная ошибка"),n[r.INCORRECT_AGE]=a("Некорректный возраст"),n[r.INCORRECT_COUNTRY]=a("Некорректный регион"),n[r.INCORRECT_USER_DATA]=a("Имя и фамилия обязательны"),n[r.NO_DATA]=a("Данные не указаны"),n);(0,F.Q)((function(){g&&i(u(g))}));var C=(0,E.useCallback)((function(e){i(v.updateProfile({first:null!=e?e:""}))}),[i]),R=(0,E.useCallback)((function(e){i(v.updateProfile({lastname:null!=e?e:""}))}),[i]),b=(0,E.useCallback)((function(e){var n;/^\d+$/.test(null!=e?e:"")&&i(v.updateProfile({age:null!==(n=Number(e))&&void 0!==n?n:0}))}),[i]),N=(0,E.useCallback)((function(e){i(v.updateProfile({city:null!=e?e:""}))}),[i]),x=(0,E.useCallback)((function(e){i(v.updateProfile({username:null!=e?e:""}))}),[i]),j=(0,E.useCallback)((function(e){i(v.updateProfile({avatar:null!=e?e:""}))}),[i]),O=(0,E.useCallback)((function(e){i(v.updateProfile({currency:e}))}),[i]),P=(0,E.useCallback)((function(e){i(v.updateProfile({country:e}))}),[i]);return(0,t.jsx)(l.W,{reducers:z,removeAfterUnmount:!0,children:(0,t.jsxs)($.T,{children:[(0,t.jsx)(V,{}),(null==h?void 0:h.length)&&(null==h?void 0:h.map((function(e){return(0,t.jsx)(m.xv,{theme:m.lg.ERROR,text:y[e]},e)}))),(0,t.jsx)(A,{data:s,isLoading:d,error:f,readonly:p,onChangeFirstname:C,onChangeLastname:R,onChangeAge:b,onChangeCity:N,onChangeUsername:x,onChangeAvatar:j,onChangeCurrency:O,onChangeCountry:P}),a("PROFILE PAGE")]})})}},1150:(e,n,a)=>{a.d(n,{W:()=>i});var r=a(5893),t=a(7294),o=a(5998),l=a(5461),i=function(e){var n=e.children,a=e.reducers,i=e.removeAfterUnmount,u=void 0===i||i,c=(0,o.oR)(),s=(0,l.T)();return(0,t.useEffect)((function(){var e=c.reducerManager.getMountedReducers();return Object.entries(a).forEach((function(n){var a=n[0],r=n[1];e[a]||(c.reducerManager.add(a,r),s({type:"@INIT ".concat(a," reducer")}))})),function(){u&&Object.entries(a).forEach((function(e){var n=e[0];e[1],c.reducerManager.remove(n),s({type:"@DESTROY ".concat(n," reducer")})}))}}),[s,a,u,c.reducerManager]),(0,r.jsx)(r.Fragment,{children:n})}},71:(e,n,a)=>{a.d(n,{q:()=>u,D:()=>l});var r=a(5893),t=a(4611);const o={Avatar:"ZqPdwJxd",small:"Vi0_lvD9",normal:"sCYemZ5v",large:"TcniS0gz"};var l,i=a(1072);!function(e){e.SMALL="small",e.NORMAL="normal",e.LARGE="large"}(l||(l={}));var u=function(e){var n,a=e.className,u=void 0===a?"":a,c=e.src,s=e.alt,d=void 0===s?"Sign a picture":s,f=e.size,v=void 0===f?l.NORMAL:f,p=((0,i.$G)().t,(n={})[o[v]]=!0,n);return(0,r.jsx)("div",{className:(0,t.A)(o.Avatar,p,[u]),children:(0,r.jsx)("img",{src:c,alt:d})})}},6925:(e,n,a)=>{a.d(n,{I:()=>l});var r=a(5893),t=a(4611);var o=a(7294),l=(0,o.memo)((function(e){var n,a=e.className,o=void 0===a?"":a,l=e.value,i=void 0===l?"":l,u=e.type,c=void 0===u?"text":u,s=e.placeholder,d=void 0===s?"":s,f=e.onChange,v=e.readonly,p=void 0!==v&&v,h=(function(e,n){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(r=Object.getOwnPropertySymbols(e);t<r.length;t++)n.indexOf(r[t])<0&&Object.prototype.propertyIsEnumerable.call(e,r[t])&&(a[r[t]]=e[r[t]])}}(e,["className","value","type","placeholder","onChange","readonly"]),(n={}).fTN1PnWu=p,n);return(0,r.jsx)("div",{className:(0,t.A)("X8EVbQ1x",h,[o]),children:(0,r.jsx)("input",{type:c,value:i,readOnly:p,onChange:function(e){null==f||f(e.target.value)},placeholder:d})})}));l.displayName="Input"},7808:(e,n,a)=>{a.d(n,{P:()=>i});var r=a(5893),t=a(4611);var o=a(1072),l=a(7294),i=function(e){(0,o.$G)().t;var n=e.className,a=void 0===n?"":n,i=e.label,u=void 0===i?"":i,c=e.value,s=e.options,d=e.readonly,f=void 0===d||d,v=e.onChange,p=(0,l.useMemo)((function(){return null==s?void 0:s.map((function(e){return(0,r.jsx)("option",{className:"JkXz98qY",value:e.value,children:e.content},e.value)}))}),[s]);return(0,r.jsxs)("div",{className:(0,t.A)("cidfdn6H",{},[a]),children:[u&&(0,r.jsx)("span",{className:"G1uuf7Bp",children:u}),(0,r.jsx)("select",{className:"VOKOuKGo",value:c,onChange:function(e){v&&(null==v||v(e.target.value))},disabled:f,children:p})]})}},314:(e,n,a)=>{a.d(n,{T:()=>d});var r=a(5893),t=a(4611);var o=a(7294),l=a(5461),i=a(6294),u=a(9250),c=a(2276),s=a(5998),d=(0,o.memo)((function(e){var n=e.className,a=void 0===n?"":n,d=e.children,f=e.onScrollEnd,v=(0,o.useRef)(),p=(0,o.useRef)(),h=(0,l.T)(),g=(0,u.TH)().pathname,y=(0,s.v9)((function(e){return(0,i.Qi)(e,g)}));!function(e){var n=e.callback,a=e.wrapperRef,r=e.triggerRef;(0,o.useEffect)((function(){var e=null;if(n){var t={root:a.current,rootMargin:"0px",threshold:1};return e=new IntersectionObserver((function(e){e[0].isIntersecting&&n()}),t),e.observe(r.current),function(){e&&r.current&&e.unobserve(r.current)}}}),[a,r,n])}({triggerRef:p,wrapperRef:v,callback:f}),(0,c.Q)((function(){v.current.scrollTop=y}));var m,C,R=(m=function(e){console.log("SCROLL"),h(i.Aw.setScrollPosition({position:e.currentTarget.scrollTop,path:g}))},500,C=(0,o.useRef)(!1),(0,o.useCallback)((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];C.current||(m.apply(void 0,e),C.current=!0,setTimeout((function(){C.current=!1}),500))}),[m,500]));return(0,r.jsxs)("section",{ref:v,className:(0,t.A)("a83jDcrK",{},[a]),onScroll:R,children:[d,f?(0,r.jsx)("div",{className:"VaPQ__zP",ref:p}):null]})}));d.displayName="Page"},2276:(e,n,a)=>{a.d(n,{Q:()=>t});var r=a(7294);function t(e){(0,r.useEffect)((function(){e()}),[])}}}]);